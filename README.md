# LikeMonday
# 졸과 착수 보고서 
## 졸업과제 진행
### 과제 배경과 방향성
최근에 나온 아이오닉 자동차가 백미러 대신 카메라를 달고 있다는 사실에서 영감을 얻어 전방 유리도 카메라와 디스플레이로 대체해서 운전자의 시야 확보에 도움을 줄 수 있으면 좋겠다고 생각했다. 굳이 유리 대신 비싼 디스플레이를 사용하는가 라는 의문이 들 수 있지만 생각보다 많은 장점이 있다. 예를 들어 어두운 밤길과 반대편에서 쌍라이트를 킨 채로 다가오는 차량은 운전자에게 있어서 매우 큰 위협요소이다. 하지만 디스플레이를 통해서 본다면 이미지 처리 모델을 이용해서 이러한 위협 요소들을 최대한 배재하므로서 운전자에게 더 나은 환경을 제공할 수 있다.
또한 차선 인식기능을 넣어서 따라서 우리는 빛 번짐과 밝기를 개선해주는 ai 모델을 적용한 차량 시스템을 개발하기로 했다. 
### 요구 조건 분석
케라스 예제에 몇가지 방법과 모델이 존재한다.
#### 학습 데이터
빛 번짐 모델을 super-resolution 모델을 사용할 예정이고 해당 모델에 적용할 학습 데이터는 DIV2K 라는 데이터 셋을 사용할 것이다. 해당 데이터 셋은 다음 링크를 가면 자세한 내용을 볼 수 있다.
https://data.vision.ee.ethz.ch/cvl/DIV2K/
DIV2K는 1000개의 2K의 화질의 이미지 데이터를 800개의 학습데이터와 100개의 검증 데이터, 100개의 테스트 데이터로 나눠서 가지고 있다. 유명한 데이터셋이라서 텐서플로우 데이터셋 라이브러리에서도 제공하고 있다.
밝기 개선 모델에 사용될 데이터 셋은 LOL 데이터 셋이다. 485개의 학습 이미지와 15개의 테스트 이미지로 구성된다.각 이미지는 밝은 이미지와 어두운 이미지의 Pair로 구성된다. 그래서 LOw Light paired를 줄여서 LOL dataset이라고 한다. 딱히 공식 사이트가 존재하는 것은 아니고 구글 드라이브에서 다운 받을 수 있다.
차선 인식 기능에는 구현하는 방법에 따라서 데이터가 필요할 수도 필요하지 않을 수도 있다. Canny Edge Detection을 이용해서 차선을 찾는 방법은 데이터가 필요하지 않느다. 하지만 위 방법은 코너와 같은 곡선 구간에서 제대로 작동하지 않을 수도 있다. 더 높은 성능이 필요하다면 딥러닝 기반의 모델을 사용한다. kaggle에서 line detection 관련 데이터 셋을 많이 찾을 수 있었고 필요하다면 나중에 사용하기로 했다.
https://www.kaggle.com/datasets/thomasfermi/lane-detection-for-carla-driving-simulator
#### 빛 번짐 완화 모델

빛 번짐을 완화하기 위해서 저해상도 이미지를 고해상도 이미지로 복원시켜주는 SRGAN(super resolution GAN)을 사용할 예정이다. GAN 이외에도 SRCNN, SRResNet 등이 있지만 연산량, 이미지 디테일 묘사 정도를 고려하여 SRGAN 방식을 채택하기로 했다. 논문 "Photo-Realistic Single Image Super-Resolution Using a Generative Adversarial Network, 2017 CVPR"에서 SRGAN의 연산과 성능을 확인할 수 있다. 학습을 위해 사용할 데이터 셋인 DIV2K은 bicubic down sampling 데이터 셋 외에도 알려지지 않은 down sampling 방식으로 제작된 데이터 셋으로 구성되어 있다. unknown down sampling 데이터 셋은 실생활에서 모델을 사용할 때도 우수한 성능을 내도록 도와줄 것이다.

#### 밝기 개선 모델

밝기 개선을 위해 두 가지 모델 후보를 검토했다. 첫 번째로는 MIRNet이 있으며, 두 번째로는 Zero-Reference Deep Curve Estimation (zero-DCE)이다. MIRNet은 LOL 데이터셋과 유사한 어두운 이미지와 해당 이미지의 밝은 버전으로 구성된 쌍 데이터셋을 사용하여 학습된다. 이에 반해 zero-DCE는 쌍 데이터셋을 필요로하지 않는다.
MIRNet은 어두운 이미지의 밝기를 개선하는 능력을 갖추고 있으며, 세부 사항을 보존하면서 이미지를 개선할 수 있다. LOL 데이터셋과 유사한 데이터셋을 사용하여 MIRNet을 학습시킨다. 이 모델은 저조도 이미지에서 밝기를 개선하는 데 탁월한 성능을 보인다.
반면에 zero-DCE는 쌍 데이터셋 없이도 이미지의 밝기를 개선할 수 있는 모델이다. zero-DCE는 입력 이미지만을 사용하여 빛의 강도 변화에 대한 커브 추정을 수행하고, 이를 통해 이미지의 밝기를 향상시킨다.
밝기 개선을 위한 딥러닝 모델로 MIRNet과 zero-DCE 중에서 어떤 모델을 최종적으로 선택할지는 평가 결과를 통해 결정할 예정이다.
#### 어플레케이션

도로에서의 빛 번짐 완화, 밝기 개선, 차선 인식을 하는 모델들은 어두운 환경에서 운전자의 주행에 도움이 될 것이다. 따라서 자동차에 쉽게 설치 가능하도록 어플리케이션 형태로 제작하고자 한다. 하지만 3가지 모델을 모두 하나의 어플리케이션에서 수행하기에는 용량, 성능 등의 문제점이 에상된다. 어플리케이션으로 우선 제작 후 실시간 주행 환경에 사용하기 어렵다는 판단이 되면 프로그램, vision processor 보드 등 다른 방식의 적용을 시도해 볼 생각이다.

### 진행 방안 및 시스템 설계

.
.

### 예상 문제점

보통 인간이 인식할 수 있는 최대 frame이 초당 60 프레임 이라고 한다. 운전자가 부드러운 영상을 보기 위해서는 적어도 60 프레임을 사용해야 한다. 우리는 ai 모델을 적용할 것이고 60 프레임이라는 요구 조건을 만족시킬 만한 inference time이 필요하다. 적어도 이미지 한 장당 inference time이 20ms 이 되어야 한다.
또한 스마트폰의 컴퓨팅 능력이 받쳐줘야 한다. 카메라가 찍고 있는 영상을 view로 rendering해주는 동시에 ai모델의 inferece까지 처리해줘야 한다. 스마트폰 로컬에서 처리하기 어렵다면 클라우드를 사용해야 하는데 이 때는 동영상 스트리밍이 원할하게 가능할 정도의 네트워크 속도와 서버가 필요하다.

### 역할 분담 및 개발 일정

.
.
.
